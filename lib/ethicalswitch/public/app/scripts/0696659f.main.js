!function(a){var b=function(a){return a.split("").reverse().join("")},c={numberStep:function(b,c){var d=Math.floor(b),e=a(c.elem);e.text(d)}},d=function(a){var b=a.elem;if(b.nodeType&&b.parentNode){var d=b._animateNumberSetter;d||(d=c.numberStep),d(a.now,a)}};a.Tween&&a.Tween.propHooks?a.Tween.propHooks.number={set:d}:a.fx.step.number=d;var e=function(a,b){for(var c,d,e,f=a.split("").reverse(),g=[],h=0,i=Math.ceil(a.length/b);i>h;h++){for(c="",e=0;b>e&&(d=h*b+e,d!==a.length);e++)c+=f[d];g.push(c)}return g},f=function(a){var c=a.length-1,d=b(a[c]);return a[c]=b(parseInt(d,10).toString()),a};a.animateNumber={numberStepFactories:{append:function(b){return function(c,d){var e=Math.floor(c),f=a(d.elem);f.prop("number",c).text(e+b)}},separator:function(c,d){return c=c||" ",d=d||3,function(g,h){var i=Math.floor(g),j=i.toString(),k=a(h.elem);if(j.length>d){var l=e(j,d);j=f(l).join(c),j=b(j)}k.prop("number",g).text(j)}}}},a.fn.animateNumber=function(){for(var b=arguments[0],d=a.extend({},c,b),e=a(this),f=[d],g=1,h=arguments.length;h>g;g++)f.push(arguments[g]);if(b.numberStep){var i=this.each(function(){this._animateNumberSetter=b.numberStep}),j=d.complete;d.complete=function(){i.each(function(){delete this._animateNumberSetter}),j&&j.apply(this,arguments)}}return e.animate.apply(e,f)}}(jQuery),!function(a){var b={sectionContainer:"section",easing:"ease",animationTime:1e3,pagination:!0,updateURL:!1,keyboard:!0,beforeMove:null,afterMove:null,loop:!1};a.fn.swipeEvents=function(){return this.each(function(){function b(a){var b=a.originalEvent.touches;b&&b.length&&(d=b[0].pageX,e=b[0].pageY,f.bind("touchmove",c)),a.preventDefault()}function c(a){var b=a.originalEvent.touches;if(b&&b.length){var g=d-b[0].pageX,h=e-b[0].pageY;g>=50&&f.trigger("swipeLeft"),-50>=g&&f.trigger("swipeRight"),h>=50&&f.trigger("swipeUp"),-50>=h&&f.trigger("swipeDown"),(Math.abs(g)>=50||Math.abs(h)>=50)&&f.unbind("touchmove",c)}a.preventDefault()}var d,e,f=a(this);f.bind("touchstart",b)})},a.fn.onepage_scroll=function(c){function d(a,b){deltaOfInterest=b;var c=(new Date).getTime();return c-lastAnimation<quietPeriod+e.animationTime?void a.preventDefault():(0>deltaOfInterest?f.moveDown():f.moveUp(),void(lastAnimation=c))}var e=a.extend({},b,c),f=a(this),g=a(e.sectionContainer);if(total=g.length,status="off",topPos=0,lastAnimation=0,quietPeriod=500,paginationList="",a.fn.transformPage=function(b,c,d){a(this).css({"-webkit-transform":"translate3d(0, "+c+"%, 0)","-webkit-transition":"all "+b.animationTime+"ms "+b.easing,"-moz-transform":"translate3d(0, "+c+"%, 0)","-moz-transition":"all "+b.animationTime+"ms "+b.easing,"-ms-transform":"translate3d(0, "+c+"%, 0)","-ms-transition":"all "+b.animationTime+"ms "+b.easing,transform:"translate3d(0, "+c+"%, 0)",transition:"all "+b.animationTime+"ms "+b.easing}),a(this).one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){"function"==typeof b.afterMove&&b.afterMove(d)})},a.fn.moveDown=function(){var b=a(this);if(index=a(e.sectionContainer+".active").data("index"),current=a(e.sectionContainer+"[data-index='"+index+"']"),next=a(e.sectionContainer+"[data-index='"+(index+1)+"']"),next.length<1){if(1!=e.loop)return;pos=0,next=a(e.sectionContainer+"[data-index='1']")}else pos=100*index*-1;if("function"==typeof e.beforeMove&&e.beforeMove(current.data("index")),current.removeClass("active"),next.addClass("active"),1==e.pagination&&(a(".onepage-pagination li a[data-index='"+index+"']").removeClass("active"),a(".onepage-pagination li a[data-index='"+next.data("index")+"']").addClass("active")),a("body")[0].className=a("body")[0].className.replace(/\bviewing-page-\d.*?\b/g,""),a("body").addClass("viewing-page-"+next.data("index")),history.replaceState&&1==e.updateURL){var c=window.location.href.substr(0,window.location.href.indexOf("#"))+"#"+(index+1);history.pushState({},document.title,c)}b.transformPage(e,pos,index)},a.fn.moveUp=function(){var b=a(this);if(index=a(e.sectionContainer+".active").data("index"),current=a(e.sectionContainer+"[data-index='"+index+"']"),next=a(e.sectionContainer+"[data-index='"+(index-1)+"']"),next.length<1){if(1!=e.loop)return;pos=100*(total-1)*-1,next=a(e.sectionContainer+"[data-index='"+total+"']")}else pos=100*(next.data("index")-1)*-1;if("function"==typeof e.beforeMove&&e.beforeMove(current.data("index")),current.removeClass("active"),next.addClass("active"),1==e.pagination&&(a(".onepage-pagination li a[data-index='"+index+"']").removeClass("active"),a(".onepage-pagination li a[data-index='"+next.data("index")+"']").addClass("active")),a("body")[0].className=a("body")[0].className.replace(/\bviewing-page-\d.*?\b/g,""),a("body").addClass("viewing-page-"+next.data("index")),history.replaceState&&1==e.updateURL){var c=window.location.href.substr(0,window.location.href.indexOf("#"))+"#"+(index-1);history.pushState({},document.title,c)}b.transformPage(e,pos,index)},f.addClass("onepage-wrapper").css("position","relative"),a.each(g,function(b){a(this).css({position:"absolute",top:topPos+"%"}).addClass("section").attr("data-index",b+1),topPos+=100,1==e.pagination&&(paginationList+="<li><a data-index='"+(b+1)+"' href='#"+(b+1)+"'></a></li>")}),f.swipeEvents().bind("swipeDown",function(){f.moveUp()}).bind("swipeUp",function(){f.moveDown()}),1==e.pagination&&(a("<ul class='onepage-pagination'>"+paginationList+"</ul>").prependTo("body"),posTop=f.find(".onepage-pagination").height()/2*-1,f.find(".onepage-pagination").css("margin-top",posTop)),""!=window.location.hash&&"#1"!=window.location.hash){if(init_index=window.location.hash.replace("#",""),a(e.sectionContainer+"[data-index='"+init_index+"']").addClass("active"),a("body").addClass("viewing-page-"+init_index),1==e.pagination&&a(".onepage-pagination li a[data-index='"+init_index+"']").addClass("active"),next=a(e.sectionContainer+"[data-index='"+init_index+"']"),next&&(next.addClass("active"),1==e.pagination&&a(".onepage-pagination li a[data-index='"+init_index+"']").addClass("active"),a("body")[0].className=a("body")[0].className.replace(/\bviewing-page-\d.*?\b/g,""),a("body").addClass("viewing-page-"+next.data("index")),history.replaceState&&1==e.updateURL)){var h=window.location.href.substr(0,window.location.href.indexOf("#"))+"#"+init_index;history.pushState({},document.title,h)}pos=100*(init_index-1)*-1,f.transformPage(e,pos,init_index)}else a(e.sectionContainer+"[data-index='1']").addClass("active"),a("body").addClass("viewing-page-1"),1==e.pagination&&a(".onepage-pagination li a[data-index='1']").addClass("active");return 1==e.pagination&&a(".onepage-pagination li a").click(function(){var b=a(this).data("index");return a(this).hasClass("active")||(current=a(e.sectionContainer+".active"),next=a(e.sectionContainer+"[data-index='"+b+"']"),next&&(current.removeClass("active"),next.addClass("active"),a(".onepage-pagination li a.active").removeClass("active"),a(".onepage-pagination li a[data-index='"+b+"']").addClass("active"),a("body")[0].className=a("body")[0].className.replace(/\bviewing-page-\d.*?\b/g,""),a("body").addClass("viewing-page-"+next.data("index"))),pos=100*(b-1)*-1,f.transformPage(e,pos,b)),0==e.updateURL?!1:void 0}),a(document).bind("mousewheel DOMMouseScroll",function(a){a.preventDefault();var b=a.originalEvent.wheelDelta||-a.originalEvent.detail;d(a,b)}),1==e.keyboard&&a(document).keydown(function(a){var b=a.target.tagName.toLowerCase();switch(a.which){case 38:"input"!=b&&"textarea"!=b&&f.moveUp();break;case 40:"input"!=b&&"textarea"!=b&&f.moveDown();break;default:return}a.preventDefault()}),!1}}(window.jQuery),$(document).ready(function(){function a(a){"connected"===a.status?(console.log("Welcome!  Fetching your information.... "),FB.api("/me",function(a){c(a),console.log("Successful login for: "+a.name),$("#status").html("Thanks for signing up, "+a.first_name+"!"),$("#login").html('Welcome to the Tribe! <span class="glyphicon glyphicon-ok">').addClass("btn-success")})):"not_authorized"===a.status||($("#status").html(""),$("#login").html('Sign up with Facebook <span class="glyphicon glyphicon-user">').removeClass("btn-success").addClass("btn-primary"))}function b(){$.get("http://api.ethicalswitch.org/users/count/",function(a){console.log(a),$(".user-count").html(a)})}function c(a){console.log("Adding user to database.... "),$.ajax({type:"POST",url:"http://api.ethicalswitch.org/users/",data:a,dataType:"json",contentType:"application/x-www-form-urlencoded",success:d})}function d(){$.get("http://api.ethicalswitch.org/users/count/",function(a){$(".user-count").html(a)})}function b(){$.get("http://api.ethicalswitch.org/users/count/",function(a){console.log(a),$(".user-count").animateNumber({number:a})})}$.ajaxSetup({cache:!0}),$.getScript("//connect.facebook.net/en_UK/all.js",function(){FB.init({appId:"1427999834129994"}),$("#loginbutton,#feedbutton").removeAttr("disabled"),FB.getLoginStatus(a)}),$("#login").click(function(){FB.login(function(b){"connected"===b.status?(c(b),a(b)):Log.info("User is logged out")})}),$("#logout").click(function(){FB.logout(function(b){a(b)})}),$("#sign-up-button").click(function(){firstName=$("#first-name").val(),lastName=$("#last-name").val(),email=$("#email").val(),firstName&&lastName&&email?($("#sign-up-error").hide(),c({first_name:firstName,last_name:lastName,email:email}),$("#display-first-name").text(firstName),$("#login").html('Welcome to the Tribe! <span class="glyphicon glyphicon-ok">').addClass("btn-success"),$("#first-name").val(""),$("#last-name").val(""),$("#email").val("")):($("#sign-up-success").hide(),$("#sign-up-error").show())}),$("#main").onepage_scroll({sectionContainer:"section",easing:"ease",animationTime:1e3,pagination:!0,updateURL:!0,beforeMove:function(){},afterMove:function(){},loop:!1,keyboard:!0,responsiveFallback:!1}),$(document).ready(function(){b(),$("#main").moveTo(1)})});